# Epic 1 Retrospective: Project Foundation & Team Management

**Date:** 2026-02-17
**Facilitator:** Bob (Scrum Master)
**Epic:** Epic 1 - Project Foundation & Team Management
**Status:** Complete (5/5 stories done)

## Team Participants

- Bob (Scrum Master) - Facilitator
- Alice (Product Owner)
- Charlie (Senior Dev)
- Dana (QA Engineer)
- Elena (Junior Dev)
- parth (Project Lead)

## Epic Summary

Epic 1 delivered the project foundation across two development tracks:

- **Backend (CLI AI tools - GPT-5 Codex):** Stories 1.1, 1.2, 1.3
- **Frontend (Lovable AI):** Stories 1.4, 1.5

### Stories Delivered

| Story | Title | Track | Tests | Review Findings |
|---|---|---|---|---|
| 1.1 | Initialize Backend Project & Health Endpoint | Backend | 5 | 0 |
| 1.2 | Member Management API | Backend | 22 | 7 |
| 1.3 | Credential Encryption & Settings API | Backend | 34 | 0 |
| 1.4 | Frontend API Layer Refactor to Adapter Pattern | UI - Lovable | smoke suite | 5 |
| 1.5 | Functional Settings Page & Connection Error Banner | UI - Lovable | 20 | 8 |

### FRs Covered

FR25, FR26, FR27, FR28, FR29, FR30, FR38, FR39, FR40, FR41, FR43, FR44

### NFRs Addressed

NFR4, NFR6, NFR7, NFR8, NFR9, NFR10, NFR14

## What Went Well

1. **100% story completion** - All 5 stories delivered and marked done with all acceptance criteria verified.
2. **Progressive test growth** across backend stories: 5 → 22 → 34 tests, demonstrating increasing coverage maturity.
3. **Clean backend architecture** established: adapter pattern, normalized error responses (`{"error": "..."}`), Fernet encryption, health-gated startup with retry/backoff.
4. **Forward-compatible design decisions**: delete-guard in Story 1.2 handles missing `tasks` table gracefully (ready for Story 2.1), adapter interface includes settings methods for Story 1.5.
5. **Two-team development model** (CLI AI backend + Lovable AI frontend) worked end-to-end with API_CONTRACT.md as the integration contract.

## Challenges

1. **UI stories had ~2x the review findings of backend stories** (avg 6.5 vs 3), driven by gaps in Lovable AI prompts.
2. **Story 1.5 had 3 HIGH findings:**
   - SettingsPage directly accessed localStorage, bypassing the adapter pattern established in Story 1.4
   - Out-of-scope packages (Playwright, dotenv) were added, violating the "no new packages" constraint
   - Missing `getConnectionSettings()` method left a gap in the ApiClient contract
3. **Lovable AI operates without project context** beyond the prompt + master doc + existing codebase. Architectural constraints and boundaries must be stated explicitly.
4. **`docs/task_flow_master_doc.md` has stale field names** in the ER diagram section (`assigned_to` instead of `assignee_id`, `is_active` instead of `active`, `update_text` instead of `content`) conflicting with `API_CONTRACT.md`.

## Key Insights

1. **Lovable AI prompts are the primary quality lever for UI stories.** They must be self-contained, explicit about constraints, and written as if onboarding a developer with zero project context beyond the UI codebase.
2. **Architectural constraints must be explicitly stated in every UI prompt.** Lovable will not infer adapter boundaries, package restrictions, or data access patterns from existing code.
3. **The review-remediation loop works but is expensive.** Better prompts upfront reduce iteration cycles. Each round-trip to Lovable involves committing to GitHub, pulling the subtree, and running the review agent.
4. **Backend stories benefited from the reviewing agent having full codebase context.** UI stories lack this advantage because Lovable operates externally.

## Process Observations

### Lovable AI Workflow

The frontend development workflow uses Lovable AI (a website-based AI code generator):

1. Story prompt is created with detailed implementation instructions
2. Prompt is copied to Lovable AI website
3. Lovable generates code changes, commits to GitHub
4. Changes are pulled into `taskflow-ui/` git subtree
5. Review agent evaluates the changes
6. If issues found, new corrective prompts are created and the cycle repeats

**Key learning:** The prompt is the only control mechanism. Everything that matters must be in the prompt.

### Master Doc Strategy

`docs/task_flow_master_doc.md` is always attached to Lovable prompts. The team agreed:
- Don't over-invest in maintaining the master doc as a Lovable context source
- Lovable always has the actual UI codebase as context
- Focus effort on making each individual prompt solid and self-contained
- Fix stale field names to prevent naming drift, but keep maintenance lightweight

## Technical Debt

| Item | Priority | Source | Impact |
|---|---|---|---|
| Dashboard duplicate client-side filtering | Low | Story 1.4 review | Duplicates mock adapter logic; refactor when real adapter is introduced (Story 4.2) |
| React Router 6.30.3 security patch | Low | Story 1.4 analysis | XSS via redirect validation; declarative mode reduces risk; track as separate maintenance story |
| Stale field names in master doc ER diagram | Medium | Retro analysis | Could cause naming confusion in Lovable-generated code |

## Action Items

### Process Improvements

1. **Enforce architectural constraints in all Lovable UI prompts**
   - Owner: SM (Bob) / parth (during story creation)
   - Success criteria: Every UI story prompt explicitly states - no package additions, all data through apiClient, no direct localStorage for app data, reference API_CONTRACT.md field names

2. **Write Lovable prompts as self-contained developer briefs**
   - Owner: SM (Bob) / parth
   - Success criteria: A developer with zero project context (beyond the UI codebase) can complete the task from the prompt alone

### Technical Debt Resolution

3. **Fix stale field names in `docs/task_flow_master_doc.md`**
   - Owner: Charlie (Dev)
   - Priority: Medium
   - Scope: Update ER diagram section - `assigned_to` → `assignee_id`, `is_active` → `active`, `update_text` → `content`

4. **Track React Router 6.30.3 security patch**
   - Owner: Charlie (Dev)
   - Priority: Low
   - Scope: Separate maintenance story outside epic scope

### Team Agreements

- Every UI story review checks for adapter boundary violations before any other finding
- Lovable prompts must include a "Constraints" section listing what NOT to do
- The `create-story` workflow should embed Lovable constraints automatically for UI-track stories

## Next Epic Preview: Epic 2 - Core Task Management

### Overview

Epic 2 delivers core task CRUD with full business logic (2 stories):
- **Story 2.1:** Task Management API — CRUD & Business Logic [Backend]
- **Story 2.2:** Task Detail Page with Adapter Pattern [UI - Lovable]

### Dependencies on Epic 1

- Members table and API (Story 1.2) - tasks reference `assignee_id` FK to `members.id`
- Adapter pattern (Story 1.4) - UI calls go through `apiClient`
- API patterns and error normalization (Stories 1.1, 1.3) - reused in task endpoints
- Story 1.2's `count_assigned_tasks` delete guard becomes active once tasks table exists

### Readiness Assessment

- **Backend readiness:** High - patterns established, API conventions proven, test infrastructure in place
- **Frontend readiness:** Medium - prompt quality improvements needed for Story 2.2
- **Blockers:** None identified
- **Preparation needed:** Prompt template improvements, stale master doc fix

## Retrospective Metrics

- **Stories completed:** 5/5 (100%)
- **Total test count (final):** 34 backend + 20 frontend = 54 tests
- **Review findings (total):** ~20 across all stories
- **Review findings resolved:** 100%
- **First retrospective:** Yes (Epic 1)
